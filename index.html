<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate AI Coding Assistant - Blackbox Killer Edition</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
<style>
/* BODY & THEME */
body { background: linear-gradient(135deg,#0f0c29,#302b63,#24243e); color:#fff; font-family:'Roboto',sans-serif; min-height:100vh; transition:all 0.5s; }
body.dark { background: linear-gradient(135deg,#1a1a2e,#16213e,#0f3460); color:#e0e0e0; }

/* CONTAINER */
.container { background: rgba(255,255,255,0.1); backdrop-filter: blur(20px); border-radius:25px; padding:50px; box-shadow:0 20px 40px rgba(0,0,0,0.6); animation:slideIn 2s ease-out; margin-bottom:100px; }
body.dark .container { background: rgba(0,0,0,0.4); }

/* CARDS */
.card { background: rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:20px; transition:all 0.3s; position:relative; margin-bottom:30px; }
.card:hover { transform: translateY(-5px); box-shadow:0 15px 30px rgba(0,0,0,0.3); }
body.dark .card { background: rgba(0,0,0,0.3); border-color: rgba(255,255,255,0.1); }

/* BUTTON PREMIUM */
.btn-premium { background: linear-gradient(45deg,#ff6b6b,#ffa500,#ff1493); border:none; color:white; font-weight:bold; transition: all 0.4s; position:relative; overflow:hidden; }
.btn-premium::before { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background: linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent); transition:left 0.5s; }
.btn-premium:hover::before { left:100%; }
.btn-premium:hover { transform: translateY(-5px) scale(1.05); box-shadow:0 10px 25px rgba(255,107,107,0.6); }

/* TEXTAREAS & CODE */
textarea, pre { background: rgba(255,255,255,0.2); border:2px solid rgba(255,255,255,0.3); color:white; border-radius:15px; font-family:'Courier New', monospace; transition: all 0.3s; }
textarea:focus, pre:focus { border-color:#ff6b6b; box-shadow:0 0 10px rgba(255,107,107,0.5); }
body.dark textarea, body.dark pre { background: rgba(0,0,0,0.5); color:#e0e0e0; }

/* PARTICLES */
.particle { position:absolute; width:6px; height:6px; background: linear-gradient(45deg,#ff6b6b,#ffa500); border-radius:50%; animation: float 8s infinite ease-in-out, glow 2s infinite alternate; }
@keyframes float {0%,100%{transform:translateY(0) rotate(0deg);}50%{transform:translateY(-30px) rotate(180deg);}}
@keyframes glow {from{box-shadow:0 0 5px #ff6b6b;} to{box-shadow:0 0 20px #ffa500;}}

/* NAVBAR */
.navbar { background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); border-bottom:1px solid rgba(255,255,255,0.1); }
body.dark .navbar { background: rgba(255,255,255,0.1); }

/* THEME TOGGLE */
.theme-toggle { position:fixed; top:20px; right:20px; z-index:1000; border-radius:50%; width:50px; height:50px; transition:all 0.3s; }

/* COPY/DOWNLOAD BTN */
.copy-btn,.download-btn { position:absolute; top:10px; right:10px; background:rgba(0,0,0,0.7); border:none; color:white; border-radius:8px; padding:5px 10px; cursor:pointer; transition:all 0.3s; }
.copy-btn:hover,.download-btn:hover { background:rgba(255,107,107,0.8);}
.download-btn { right:70px; }

/* LOADING & PROGRESS */
.loading { display:none; text-align:center; margin-top:10px; color:#ff6b6b;}
.progress-bar { background: linear-gradient(45deg,#ff6b6b,#ffa500); transition: width 0.5s; }

/* CHAT MINI AI */
.chat-container { position:fixed; bottom:20px; right:20px; width:350px; height:450px; background:rgba(255,255,255,0.1); backdrop-filter:blur(15px); border-radius:20px; display:none; flex-direction:column; box-shadow:0 10px 30px rgba(0,0,0,0.5); animation: chatSlide 0.5s ease-out; }
@keyframes chatSlide { from{transform:translateY(100px);opacity:0;} to{transform:translateY(0);opacity:1;} }
.chat-messages { flex:1; padding:15px; overflow-y:auto; scrollbar-width:thin; scrollbar-color:#ff6b6b rgba(255,255,255,0.2);}
.chat-input { padding:15px; background:rgba(255,255,255,0.2); border:none; border-radius:0 0 20px 20px; color:white; font-size:16px; }

/* AUTOCOMPLETE */
.autocomplete { position:absolute; background: rgba(0,0,0,0.8); border-radius:10px; max-height:200px; overflow-y:auto; z-index:1000; display:none;}
.autocomplete-item { padding:10px; cursor:pointer; border-bottom:1px solid rgba(255,255,255,0.1);}
.autocomplete-item:hover{background:rgba(255,107,107,0.5);}
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg animate__animated animate__fadeInDown">
<div class="container-fluid">
<a class="navbar-brand" href="#"><i class="fas fa-code"></i> AI Coding Blackbox Killer</a>
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarNav">
<ul class="navbar-nav ms-auto">
<li class="nav-item"><a class="nav-link" href="/login">Login</a></li>
<li class="nav-item"><a class="nav-link" href="/register">Register</a></li>
<li class="nav-item"><a class="nav-link" href="#" onclick="toggleHistory()">History</a></li>
<li class="nav-item"><a class="nav-link" href="#" onclick="showTutorial()">Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="#" onclick="toggleChat()">Chat AI</a></li>
</ul>
</div>
</div>
</nav>

<div class="container mt-5 animate__animated animate__fadeInUp">
<h1 class="text-center mb-4"><i class="fas fa-robot"></i> Ultimate AI Coding Assistant</h1>
<p class="text-center mb-5">Generate, Fix, Review, Optimize, Refactor kode + mini AI chat + autocomplete + syntax highlight + history!</p>

<!-- ROW -->
<div class="row">
<div class="col-lg-6">
<div class="card p-4 animate__animated animate__slideInLeft">
<h3><i class="fas fa-magic"></i> Generate Kode</h3>
<select id="lang" class="form-select mb-3">
<option value="python">Python</option>
<option value="javascript">JavaScript</option>
<option value="java">Java</option>
<option value="cpp">C++</option>
<option value="csharp">C#</option>
<option value="php">PHP</option>
<option value="ruby">Ruby</option>
<option value="go">Go</option>
<option value="swift">Swift</option>
<option value="kotlin">Kotlin</option>
<option value="rust">Rust</option>
<option value="typescript">TypeScript</option>
<option value="scala">Scala</option>
<option value="perl">Perl</option>
<option value="lua">Lua</option>
</select>
<div style="position:relative;">
<textarea id="prompt" class="form-control mb-3" rows="5" placeholder="Tulis prompt kamu..." oninput="showAutocomplete(this)"></textarea>
<div id="autocomplete" class="autocomplete"></div>
</div>
<button class="btn btn-premium w-100" onclick="generateCode()">Generate <i class="fas fa-wand-magic-sparkles"></i></button>
<div class="loading" id="gen-loading"><i class="fas fa-spinner fa-spin"></i> Generating...</div>
<pre id="generated-code" class="mt-3 p-3 rounded language-python"><code></code></pre>
<button class="copy-btn" onclick="copyToClipboard('generated-code')"><i class="fas fa-copy"></i></button>
<button class="download-btn" onclick="downloadCode('generated-code')"><i class="fas fa-download"></i></button>
</div>
</div>

<div class="col-lg-6">
<div class="card p-4 animate__animated animate__slideInRight">
<h3><i class="fas fa-wrench"></i> Fix Kode</h3>
<textarea id="code-input" class="form-control mb-3" rows="5" placeholder="Kode bermasalah"></textarea>
<textarea id="error-input" class="form-control mb-3" rows="2" placeholder="Deskripsi error"></textarea>
<button class="btn btn-premium w-100" onclick="fixCode()">Fix <i class="fas fa-tools"></i></button>
<div class="loading" id="fix-loading"><i class="fas fa-spinner fa-spin"></i> Fixing...</div>
<pre id="fixed-code" class="mt-3 p-3 rounded"><code></code></pre>
<button class="copy-btn" onclick="copyToClipboard('fixed-code')"><i class="
fas fa-copy"></i></button>
<button class="download-btn" onclick="downloadCode('fixed-code')"><i class="fas fa-download"></i></button>
</div>
</div>
</div> <!-- end row -->

<!-- HISTORY PANEL -->
<div id="history-panel" class="card p-4 mt-5 animate__animated animate__fadeIn" style="display:none;">
<h3><i class="fas fa-history"></i> History Kode</h3>
<input type="text" id="history-search" class="form-control mb-3" placeholder="Search history..." oninput="filterHistory()">
<ul id="history-list" class="list-group"></ul>
</div>

<!-- MINI AI CHAT -->
<div id="chat-container" class="chat-container d-flex flex-column">
<div class="chat-messages" id="chat-messages"></div>
<input type="text" id="chat-input" class="chat-input" placeholder="Tanya AI..." onkeydown="if(event.key==='Enter'){sendChat()}">
</div>

<!-- TUTORIAL COLLAPSIBLE -->
<div id="tutorial-panel" class="card p-4 mt-5 animate__animated animate__fadeIn" style="display:none;">
<h3><i class="fas fa-book-open"></i> Tutorial Cepet</h3>
<ul>
<li>Gunakan prompt spesifik untuk hasil lebih akurat</li>
<li>Pilih bahasa coding yang sesuai</li>
<li>Gunakan fitur Fix & Optimize untuk kode lebih bersih</li>
<li>History menyimpan semua kode kamu</li>
<li>Mini AI chat siap bantu brainstorming coding</li>
</ul>
</div>

<!-- PARTICLES EFFECT -->
<script>
for(let i=0;i<30;i++){
    let p=document.createElement('div');
    p.className='particle';
    p.style.left=Math.random()*window.innerWidth+'px';
    p.style.top=Math.random()*window.innerHeight+'px';
    document.body.appendChild(p);
}
</script>

<!-- JS LIBRARIES -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script>
function toggleHistory(){ 
    const panel=document.getElementById('history-panel');
    panel.style.display=panel.style.display==='none'?'block':'none';
}
function toggleChat(){
    const chat=document.getElementById('chat-container');
    chat.style.display=chat.style.display==='none'?'flex':'none';
}
function showTutorial(){
    const tutorial=document.getElementById('tutorial-panel');
    tutorial.style.display=tutorial.style.display==='none'?'block':'none';
}

function copyToClipboard(id){
    const text=document.getElementById(id).innerText;
    navigator.clipboard.writeText(text);
    alert('Copied to clipboard!');
}

function downloadCode(id){
    const text=document.getElementById(id).innerText;
    const blob=new Blob([text],{type:'text/plain'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;
    a.download='code.txt';
    a.click();
    URL.revokeObjectURL(url);
}

// MINI AI CHAT FUNCTION
async function sendChat(){
    const input=document.getElementById('chat-input');
    const msg=input.value.trim();
    if(!msg) return;
    const chatBox=document.getElementById('chat-messages');
    chatBox.innerHTML+='<div><b>You:</b> '+msg+'</div>';
    input.value='';
    // send ke API /chat
    try{
        const res=await fetch('/generate_code',{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({prompt:msg, lang:'python'})
        });
        const data=await res.json();
        chatBox.innerHTML+='<div><b>AI:</b> '+(data.code||data.error)+'</div>';
        chatBox.scrollTop=chatBox.scrollHeight;
    }catch(e){
        chatBox.innerHTML+='<div style="color:red;"><b>Error:</b> '+e+'</div>';
    }
}

// GENERATE CODE
async function generateCode(){
    const prompt=document.getElementById('prompt').value;
    const lang=document.getElementById('lang').value;
    const loading=document.getElementById('gen-loading');
    const codeBox=document.getElementById('generated-code').querySelector('code');
    if(!prompt) return alert('Prompt diperlukan!');
    loading.style.display='block';
    try{
        const res=await fetch('/generate_code',{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({prompt,lang})
        });
        const data=await res.json();
        if(data.code) codeBox.textContent=data.code;
        Prism.highlightAll();
    }catch(e){alert(e);}
    loading.style.display='none';
}

// FIX CODE
async function fixCode(){
    const code=document.getElementById('code-input').value;
    const error=document.getElementById('error-input').value;
    const loading=document.getElementById('fix-loading');
    const codeBox=document.getElementById('fixed-code').querySelector('code');
    if(!code) return alert('Kode diperlukan!');
    loading.style.display='block';
    try{
        const res=await fetch('/fix_code',{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({code,error})
        });
        const data=await res.json();
        if(data.fixed_code) codeBox.textContent=data.fixed_code;
        Prism.highlightAll();
    }catch(e){alert(e);}
    loading.style.display='none';
}

// AUTOCOMPLETE EXAMPLE
const suggestions=['create function','loop over array','sort list','api call','read file','write file','optimize','refactor'];
function showAutocomplete(input){
    const val=input.value.toLowerCase();
    const list=document.getElementById('autocomplete');
    list.innerHTML='';
    if(!val) return list.style.display='none';
    const matches=suggestions.filter(s=>s.includes(val));
    matches.forEach(m=>{
        const div=document.createElement('div');
        div.className='autocomplete-item';
        div.innerText=m;
        div.onclick=()=>{input.value=m; list.style.display='none';};
        list.appendChild(div);
    });
    list.style.display=matches.length? 'block':'none';
}

// HISTORY SEARCH FILTER
function filterHistory(){
    const input=document.getElementById('history-search').value.toLowerCase();
    const items=document.querySelectorAll('#history-list li');
    items.forEach(i=>{
        i.style.display=i.innerText.toLowerCase().includes(input)?'block':'none';
    });
}

// DARK/LIGHT THEME TOGGLE
const btnTheme=document.createElement('button');
btnTheme.className='btn btn-light theme-toggle';
btnTheme.innerHTML='<i class="fas fa-adjust"></i>';
btnTheme.onclick=()=>document.body.classList.toggle('dark');
document.body.appendChild(btnTheme);
</script>
</body>
</html>                                                        
